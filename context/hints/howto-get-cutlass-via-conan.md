# How to Get CUTLASS via Conan (Conan 2 + CMake)

## Goal

Install NVIDIA CUTLASS via Conan (from ConanCenter) and consume it from a CMake project.

## Quick Notes

- CUTLASS is largely header/template-based; you can fetch it via Conan, but compiling CUDA kernels typically still requires a CUDA toolchain (NVCC + CUDA headers) available on your machine or in your environment.
- Conan’s recommended CMake integration for Conan 2 is `CMakeToolchain` + `CMakeDeps`.

## Step 0: Prereqs

- Conan 2 installed (`conan --version`)
- CMake 3.15+ (for `CMakeDeps`)

## Step 1: Find a CUTLASS Version

List available versions from ConanCenter:

```bash
conan list "cutlass/*" -r conancenter
```

## Step 2A: Add CUTLASS to a `conanfile.py`

In your project recipe (`conanfile.py`), add a requirement:

```py
def requirements(self):
    self.requires("cutlass/3.5.1")
```

Or as a class attribute:

```py
requires = "cutlass/3.5.1"
```

Make sure your recipe generates CMake integration files:

```py
from conan.tools.cmake import CMakeToolchain, CMakeDeps

def generate(self):
    CMakeDeps(self).generate()
    tc = CMakeToolchain(self)
    tc.generate()
```

## Step 2B (Alternative): Add CUTLASS to a `conanfile.txt`

This is a quick way to try it out without a Python recipe:

```ini
[requires]
cutlass/3.5.1

[generators]
CMakeDeps
CMakeToolchain
```

## Step 3: Install Dependencies

```bash
conan install . -b missing
```

This generates CMake package config files in your Conan output folder (for example `build/Release/` or `build/Release/generators/`, depending on your layout/output settings).

## Step 4: Use CUTLASS from CMake

With Conan’s `CMakeDeps`, CUTLASS is exposed as a CMake package + target:

```cmake
find_package(NvidiaCutlass CONFIG REQUIRED)
target_link_libraries(your_target PRIVATE nvidia::cutlass::cutlass)
```

If you are using Conan’s generated CMake presets/toolchain, configure/build like:

```bash
cmake --preset conan-release
cmake --build --preset conan-release -j
```

## Verification (Optional)

After `conan install`, you can sanity-check what was generated by searching for the package config and target name in the output folder:

```bash
rg -n "find_package\\(NvidiaCutlass\\)|nvidia::cutlass::cutlass" build
```

## Troubleshooting

- CMake cannot find `NvidiaCutlass`: ensure you are configuring CMake with Conan’s generated toolchain/presets (or pass `-DCMAKE_TOOLCHAIN_FILE=.../conan_toolchain.cmake` and ensure `CMAKE_PREFIX_PATH` includes the Conan generator folder).
- You can fetch CUTLASS headers via Conan, but if you compile CUDA code you still need CUDA/NVCC available; consider installing CUDA in user-space (e.g., Pixi CUDA packages) or using system CUDA.

## Sources

- Conan docs (CMake integration): https://docs.conan.io/2/
- ConanCenter recipe for CUTLASS: https://conan.io/center/recipes/cutlass
- CUTLASS (upstream): https://github.com/NVIDIA/cutlass
